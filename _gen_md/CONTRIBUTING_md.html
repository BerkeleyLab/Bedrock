<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CONTRIBUTING &mdash; Bedrock  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="badger README" href="badger/README_md.html" />
    <link rel="prev" title="General Docs" href="../general-docs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Bedrock
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../general-docs.html">General Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../general-docs.html#docs">Docs</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">CONTRIBUTING</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#contributing-guidelines">Contributing Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="badger/README_md.html">badger README</a></li>
<li class="toctree-l3"><a class="reference internal" href="badger/doc/README_md.html">doc README</a></li>
<li class="toctree-l3"><a class="reference internal" href="badger/mem_gate_md.html">badger mem_gate</a></li>
<li class="toctree-l3"><a class="reference internal" href="badger/status_md.html">badger status</a></li>
<li class="toctree-l3"><a class="reference internal" href="board_support/bmb7_kintex/README_md.html">bmb7_kintex README</a></li>
<li class="toctree-l3"><a class="reference internal" href="board_support/zest/README_md.html">zest README</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-tools/cdc_snitch_md.html">build-tools cdc_snitch</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-tools/makefile_md.html">build-tools makefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-tools/newad_md.html">build-tools newad</a></li>
<li class="toctree-l3"><a class="reference internal" href="dsp/README_md.html">dsp README</a></li>
<li class="toctree-l3"><a class="reference internal" href="fpga_family/xilinx/README_md.html">xilinx README</a></li>
<li class="toctree-l3"><a class="reference internal" href="guidelines/rtl_guidelines_md.html">guidelines rtl_guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="peripheral_drivers/i2cbridge/README_md.html">i2cbridge README</a></li>
<li class="toctree-l3"><a class="reference internal" href="peripheral_drivers/idelay_scanner/README_md.html">idelay_scanner README</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects/common/README_md.html">common README</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects/comms_top/README_md.html">comms_top README</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects/oscope/bmb7_cu/README_md.html">bmb7_cu README</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects/oscope/marble_family/README_md.html">marble_family README</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects/test_marble_family/README_md.html">test_marble_family README</a></li>
<li class="toctree-l3"><a class="reference internal" href="projects/test_marble_family/i2c/README_md.html">i2c README</a></li>
<li class="toctree-l3"><a class="reference internal" href="rtsim/README_md.html">rtsim README</a></li>
<li class="toctree-l3"><a class="reference internal" href="serial_io/chitchat/README_md.html">chitchat README</a></li>
<li class="toctree-l3"><a class="reference internal" href="serial_io/chitchat/chitchat_txrx_wrap_md.html">chitchat chitchat_txrx_wrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="soc/picorv32/README_md.html">picorv32 README</a></li>
<li class="toctree-l3"><a class="reference internal" href="soc/picorv32/test/badger_lwip/README_md.html">badger_lwip README</a></li>
<li class="toctree-l3"><a class="reference internal" href="soc/picorv32/test/fv/README_md.html">fv README</a></li>
<li class="toctree-l3"><a class="reference internal" href="soc/picorv32/test/lb_bridge/README_md.html">lb_bridge README</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bedrock-modules.html">Bedrock Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtsim-module.html">RTSIM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dsp-digaree-module.html">DSP Digaree Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bedrock</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../general-docs.html">General Docs</a></li>
      <li class="breadcrumb-item active">CONTRIBUTING</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_gen_md/CONTRIBUTING_md.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This documentation is a work in progress.
Expect to see errors and unfinished things.</p>
</div>
<section id="contributing">
<span id="id1"></span><h1>CONTRIBUTING<a class="headerlink" href="#contributing" title="Permalink to this heading"></a></h1>
<section id="contributing-guidelines">
<h2>Contributing Guidelines<a class="headerlink" href="#contributing-guidelines" title="Permalink to this heading"></a></h2>
<p>Entails contribution guidelines to all projects in the group hdl-libraries.
We are actively looking for meaningful contributions to our codebase. A
meaningful contribution can entail anything from:</p>
<ol class="arabic simple">
<li><p>A typo</p></li>
<li><p>A readability enhancement</p></li>
<li><p>A code or Makefile simplification</p></li>
<li><p>A bug report</p></li>
<li><p>A test</p></li>
<li><p>A new source file that you deem fits into this codebase and
preferably a test that goes with it!</p></li>
<li><p>Support for a new board or a chip on the existing projects</p></li>
<li><p>A new project</p></li>
<li><p>A new way to build code within the code base</p></li>
<li><p>New synthesis or simulation framework</p></li>
</ol>
<section id="tl-dr">
<h3>TL;DR<a class="headerlink" href="#tl-dr" title="Permalink to this heading"></a></h3>
<section id="adding-a-small-feature">
<h4>Adding a small feature?<a class="headerlink" href="#adding-a-small-feature" title="Permalink to this heading"></a></h4>
<ol class="arabic simple">
<li><p>Create a branch, and write code following guidelines here</p></li>
<li><p>Add tests</p></li>
<li><p>Add them to CI, and ensure they are passing with all the other tests you may have inadvertently broken</p></li>
<li><p>Make a pull request and have somebody else other than you merge it into master</p></li>
<li><p>Feel free to request for help during any stage</p></li>
</ol>
</section>
<section id="adding-a-large-feature">
<h4>Adding a large feature?<a class="headerlink" href="#adding-a-large-feature" title="Permalink to this heading"></a></h4>
<ol class="arabic simple">
<li><p>Start an issue or a wiki link with a detailed feature description/request</p></li>
<li><p>Obtain general consensus or feedback</p></li>
<li><p>Create a branch, and start a Merge/Pull Request at an early stage, in order to get early feedback from community</p></li>
<li><p>Add tests</p></li>
<li><p>Add them to CI, and ensure they are passing with all the other tests you may have inadvertently broken</p></li>
<li><p>Add documentation</p></li>
<li><p>Feel free to request for help during any stage</p></li>
</ol>
</section>
</section>
<section id="code-of-conduct">
<h3>Code of Conduct<a class="headerlink" href="#code-of-conduct" title="Permalink to this heading"></a></h3>
<p>Behavior in this community is always expected to be professional, courteous, and constructive.
Berkeley Lab in particular mandates support of
<a class="reference external" href="https://diversity.lbl.gov/">Inclusion, Diversity, Equity, and Accountability</a>.
Please make all contributors feel welcome, assume good intent, and be considerate of others.
On-line, that often means re-reading your messages carefully before pressing “send.”</p>
<p>Our team supports the principles and goals expressed in/by the
<a class="reference external" href="https://www.contributor-covenant.org/">Contributor Covenant</a>.
As employees of the University of California, where this project is
part of our workplace environment, it is not obvious that we have
the right to unilaterally choose, impose, or enforce such a covenant.</p>
</section>
<section id="contents-of-a-repository">
<h3>Contents of a repository<a class="headerlink" href="#contents-of-a-repository" title="Permalink to this heading"></a></h3>
<p>A source repository should be primarily reserved for source code.
“The source code for a work means the preferred form of the work for
making modifications to it.”</p>
<p>Occasionally binary files will creep in, for example visual images
for documentation purposes.  Each such file demands some note as to
how it was generated.</p>
<p>All checked-in files should be permissively licensed, consistent with
the <a class="reference external" href="LICENSE.md">LICENSE.md</a> file.</p>
<p>Sometimes files are needed that can be legally downloaded from the public Internet,
but we either don’t have permission to redistribute them, or we have other reasons to
not want them checked into this repository (all GPL code falls in this category,
due to guidance from University of California lawyers).  It’s OK to script the
download of these files; please include a check that the result has the expected
<a class="reference external" href="https://en.wikipedia.org/wiki/SHA-2">SHA256</a>. Do NOT redistribute or embed
any files within Bedrock unless they have a suitably permissive license.
Any download steps should be visibly documented, and users are encouraged to take that step
once per repository checkout. An example (not currently in use – that’s another story) is found in
<a class="reference external" href="build-tools/riscv_prep.sh">riscv_prep.sh</a>, which downloads source files needed to build
a riscv toolchain (binutils, gcc, newlib), and is used in building our CI Docker image.</p>
<p>Please do NOT check-in machine generated code. If unavoidable, document it explicitly,
and give instructions for how to reproduce.</p>
<p>Understanding that the choice of a programming language depends on the task at hand:
Currently, synthesizable code is written in Verilog, machine-generated Verilog
typically comes from Python, test benches that are too complex for Verilog resort to Python,
and network runtime support is in Python, C, or C++.</p>
<p>Standard implementations and standard libraries are preferred for obvious reasons.</p>
<p>Automatic generation of documentation is a topic of current discussion. Suggestions welcome!</p>
</section>
<section id="makefiles">
<h3>Makefiles<a class="headerlink" href="#makefiles" title="Permalink to this heading"></a></h3>
<p>We have an <a class="reference external" href="build-tools/makefile.md">explanation</a> about how
our existing Makefiles are put together.</p>
</section>
<section id="reproducible-builds">
<h3>Reproducible builds<a class="headerlink" href="#reproducible-builds" title="Permalink to this heading"></a></h3>
<p>All constructed files (sometimes called artifacts) should be reproducible.
See <a class="reference external" href="https://reproducible-builds.org">reproducible-builds.org</a>.  This includes pretty much any machine-generated file.</p>
<p>Purposefully embedded “built-on” date stamps are deprecated; use
a git commit ID (or similar) instead.</p>
<p>PDF and object files often take extra effort to make reproducible.</p>
<p>FPGA bitfiles are not typically shown to be reproducible, but Xilinx
<a class="reference external" href="https://support.xilinx.com/s/article/61599">acknowledges</a> that is a
reasonable goal (they call it “repeatable”).
Our toolchain has demonstrated this working in at least couple of cases.</p>
</section>
<section id="readability">
<h3>Readability<a class="headerlink" href="#readability" title="Permalink to this heading"></a></h3>
<p>Readability is a key goal for shared software. Lowering the barrier of entry for
a newcomer enables the codebase to flourish. This can be easily achieved by adhering
to commonly accepted best practices. Although, it may be impractical to adhere to
every single best practice: reading guidelines, reviewing each others code, and
having healthy discussions can tremendously improve the standard of software.</p>
<p>We’re not the first group to deal with this topic. The following are
useful resources:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.kernel.org/doc/html/v4.10/process/coding-style.html">Linux kernel coding style guide</a> many of the concepts it discusses have general applicability.</p></li>
<li><p><a class="reference external" href="http://google.github.io/styleguide/pyguide.html">Google python guide</a> and <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/prep/standards/html_node/Makefile-Conventions.html">GNU Coding Standards: Makefile Conventions</a></p></li>
</ol>
<p>Please spell-check your code, comments, and documentation.</p>
<section id="a-few-rules-of-thumb">
<h4>A few rules of thumb<a class="headerlink" href="#a-few-rules-of-thumb" title="Permalink to this heading"></a></h4>
<section id="naming">
<h5>Naming<a class="headerlink" href="#naming" title="Permalink to this heading"></a></h5>
<p>(This includes traditional function and variable names in compiled languages
like C, as wall as the various user-created names in Python, and wires,
regs, and module names in Verilog)</p>
<p>In most use cases and languages, please avoid CamelCase. You can resort to
snake_case instead to enhance readability of long names.</p>
<p>See Linux coding style “4) Naming”.  Pay attention to the namespace.
Use names that are easy to read and type, and that are not too hard to
grep for.</p>
<p>If you can reuse an existing name, for instance in Verilog using
the same name for a reg and the port name of a module that receives
that value, please do so.  Creating new and slightly different names
for the same thing is a wasteful cognitive load.</p>
</section>
<section id="whitespace">
<h5>Whitespace<a class="headerlink" href="#whitespace" title="Permalink to this heading"></a></h5>
<p>Readability is the goal, and specialized techniques to gain readability
(like vertical alignment of parallel semantics) is allowed and even encouraged.</p>
<p>Trailing whitespace is pure useless entropy.</p>
<p>Unix-style line breaks, ASCII 0x0a.</p>
<p>No other control characters besides 0x0a (LF) and 0x09 (HT) in text/source files.</p>
<p>See comments above concerning binary files.</p>
<p>Tabs should not be used in any place other than the beginning of a line; doing so
invites “tab damage”.  OTOH, using tabs consistently at the beginning of lines
to represent logical indentation level has advantages; people’s setting of tab
width can systematically and locally adjust the visual indentation level. Just
like Wikipedia’s English vs. American spelling policy, don’t gratuitously
change the tab vs. spaces convention of a file.  See also
<a class="reference external" href="https://www.youtube.com/watch?v=SsoOG6ZeyUI">Silicon Valley - S03E06 - Tabs versus Spaces</a> (2:50).</p>
<dl class="simple">
<dt>Special case for python files:</dt><dd><p>No tabs, per <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a></p>
</dd>
<dt>Special case for Makefiles:</dt><dd><p>Semantic tabs</p>
</dd>
<dt>Special case for Xcircuit PostScript files:</dt><dd><p>See <a class="reference external" href="build-tools/hack_xcirc">hack_xcirc</a>; consider creating and submitting a patch to</p>
</dd>
</dl>
<p>avoid this in the distant future.</p>
</section>
</section>
<section id="verilog">
<h4>Verilog<a class="headerlink" href="#verilog" title="Permalink to this heading"></a></h4>
<section id="of-syntax">
<h5>Of syntax<a class="headerlink" href="#of-syntax" title="Permalink to this heading"></a></h5>
<p>Verilog files should always start with a human-readable description of
its function.  Adding a template giving name, version, and author is
discouraged; that’s what we have version control for.</p>
<p>Use ANSI-C style port naming, as introduced in Verilog-2001.
Suggest a high proportion of comments connected with the port definitions.</p>
<p>Pay extra attention to module names, that are global in Verilog,
see “Universal considerations for names” above.</p>
<p>Pay extra attention to “8) Commenting” in Linux kernel style guide.</p>
<p>Verilog include files should use “.vh” as the name suffix.</p>
<p>Suggest, but do not mandate, tabs for logical indentation level, see above.</p>
<p>Verilog modules tend to be longer on average than C functions.  This is partially
an unfortunate consequence of the limitations of Verilog and the overhead involved
in constructing a new layer/module.  That is no excuse for pathologically long
and complicated modules, that egregiously violate Linux style guide section
“6) Functions”.  Please find ways to break up and/or autogenerate those modules.</p>
</section>
<section id="of-semantics">
<h5>Of semantics<a class="headerlink" href="#of-semantics" title="Permalink to this heading"></a></h5>
<p>Most of our effort should be focused on portable synthesizable Verilog modules
and their testing.  FPGA-specific instantiations (e.g., clock management and
MGTs) should be separated from our functional code.  Too-tight a connection
between them gets in the way of testing, since the Xilinx-supplied models are
non-redistributable and sometimes encrypted.</p>
<p>Portable synthesizable code should be written in a way that makes the hardware
representation clear to both humans and the synthesizer.  All logic, flip-flops,
multipliers, and RAM should be inferred.</p>
<p>Most of our code is intended to run at relatively high clock rates.  Even
modules that don’t actually need high throughput are often put in a clock
domain shared with high-throughput logic.  This consideration necessitates
strongly pipelined logic.</p>
</section>
</section>
<section id="coding-and-style-guidelines">
<h4>Coding and style guidelines<a class="headerlink" href="#coding-and-style-guidelines" title="Permalink to this heading"></a></h4>
<p>In addition to the general recommendations above, we strive for a uniform
Verilog coding style that emphasizes readability, reduces systematic errors and promotes
code re-use. The <a class="reference external" href="guidelines/rtl_guidelines.md">RTL Guidelines</a> document, which is itself
open to improvements and suggestions, attempts to formalize this process in the
form of coding and style guidelines that apply to some of the most common facets of RTL coding.</p>
</section>
<section id="python">
<h4>Python<a class="headerlink" href="#python" title="Permalink to this heading"></a></h4>
<p>We want all python files compatible with python2 and python3.
Some legacy code can be tolerated as python2 only.
Some new code can be tolerated as python3 only.</p>
<p>A quick book for understanding patterns and Python in general: <a class="reference external" href="https://effectivepython.com/">https://effectivepython.com/</a></p>
</section>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this heading"></a></h3>
<p>Ideally all code will be paired with a regression test that fully exercises
its functionality, maybe even cross-checked with a code coverage tool.
The more complex the function, the more important are such tests.</p>
<p>In general, file foo.v should define module foo, and have an associated
testbench in file foo_tb.v (which defines module foo_tb).  There will be
exceptions to this rule.  It’s OK for other modules to be defined in
file foo.v, if they will never be instantiated by by any other code.
If possible, the testbench will give foo a thorough exercise, and print
PASS only if everything checks out.  More complex tests may involve
helper code in e.g., python, that will determine if the module is performing
as expected.  In all cases, the regression tests will be automated by
a Makefile rule called foo_check.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../general-docs.html" class="btn btn-neutral float-left" title="General Docs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="badger/README_md.html" class="btn btn-neutral float-right" title="badger README" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, LBNL ATG.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>