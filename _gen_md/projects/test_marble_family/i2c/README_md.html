<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>i2c README &mdash; Bedrock  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="rtsim README" href="../../../rtsim/README_md.html" />
    <link rel="prev" title="test_marble_family README" href="../README_md.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Bedrock
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../general-docs.html">General Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../../general-docs.html#docs">Docs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../CONTRIBUTING_md.html">CONTRIBUTING</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../badger/README_md.html">badger README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../badger/doc/README_md.html">doc README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../badger/mem_gate_md.html">badger mem_gate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../badger/status_md.html">badger status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../board_support/bmb7_kintex/README_md.html">bmb7_kintex README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../board_support/zest/README_md.html">zest README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../build-tools/cdc_snitch_md.html">build-tools cdc_snitch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../build-tools/makefile_md.html">build-tools makefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../build-tools/newad_md.html">build-tools newad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dsp/README_md.html">dsp README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fpga_family/xilinx/README_md.html">xilinx README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../guidelines/rtl_guidelines_md.html">guidelines rtl_guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../peripheral_drivers/i2cbridge/README_md.html">i2cbridge README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../peripheral_drivers/idelay_scanner/README_md.html">idelay_scanner README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/README_md.html">common README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../comms_top/README_md.html">comms_top README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../oscope/bmb7_cu/README_md.html">bmb7_cu README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../oscope/marble_family/README_md.html">marble_family README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README_md.html">test_marble_family README</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">i2c README</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#marble-platform-support-for-i2cbridge-programming">Marble Platform Support for I2CBridge Programming</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../rtsim/README_md.html">rtsim README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../serial_io/chitchat/README_md.html">chitchat README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../serial_io/chitchat/chitchat_txrx_wrap_md.html">chitchat chitchat_txrx_wrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../soc/picorv32/README_md.html">picorv32 README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../soc/picorv32/test/badger_lwip/README_md.html">badger_lwip README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../soc/picorv32/test/fv/README_md.html">fv README</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../soc/picorv32/test/lb_bridge/README_md.html">lb_bridge README</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bedrock-modules.html">Bedrock Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../rtsim-module.html">RTSIM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dsp-digaree-module.html">DSP Digaree Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Bedrock</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../general-docs.html">General Docs</a></li>
      <li class="breadcrumb-item active">i2c README</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/_gen_md/projects/test_marble_family/i2c/README_md.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This documentation is a work in progress.
Expect to see errors and unfinished things.</p>
</div>
<section id="i2c-readme">
<span id="readme"></span><h1>i2c README<a class="headerlink" href="#i2c-readme" title="Permalink to this heading"></a></h1>
<section id="marble-platform-support-for-i2cbridge-programming">
<h2>Marble Platform Support for I2CBridge Programming<a class="headerlink" href="#marble-platform-support-for-i2cbridge-programming" title="Permalink to this heading"></a></h2>
<section id="usage">
<h3>Usage:<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h3>
<p>These tools assume usage of the i2cbridge modules in <code class="docutils literal notranslate"><span class="pre">bedrock/peripheral_drivers/i2cbridge</span></code>.
See the readme there for documentation on i2cbridge (‘i2c_chunk’).
While <code class="docutils literal notranslate"><span class="pre">i2cbridge</span></code> is a generic (platform-independent) tool, there is a lot of benefit to
be gained by wrapping the generic tool in a platform-specific interface such as this.</p>
<p>Pros:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Better</span> <span class="bp">self</span><span class="o">-</span><span class="n">documentation</span>
<span class="mf">2.</span> <span class="n">Requires</span> <span class="n">no</span> <span class="n">knowledge</span> <span class="n">of</span> <span class="n">I2C</span> <span class="n">addresses</span> <span class="ow">or</span> <span class="n">bus</span> <span class="n">multiplexing</span>
<span class="mf">3.</span> <span class="n">Code</span> <span class="n">can</span> <span class="n">be</span> <span class="n">easily</span> <span class="n">ported</span> <span class="n">to</span> <span class="n">another</span> <span class="n">platform</span> <span class="k">with</span> <span class="n">a</span> <span class="n">compatible</span> <span class="n">support</span> <span class="n">package</span>
</pre></div>
</div>
</section>
<section id="demos">
<h3>Demos:<a class="headerlink" href="#demos" title="Permalink to this heading"></a></h3>
<p>See the file <code class="docutils literal notranslate"><span class="pre">demo_marble_i2c.py</span></code>.  This is a demonstration application-specific I2C program
generator.  The function <code class="docutils literal notranslate"><span class="pre">build_prog</span></code> contains the full program instructions and is easy to
read and (hopefully) understand.  This program can generate four different output files which
can all be made my simply running <code class="docutils literal notranslate"><span class="pre">make</span></code>.</p>
<section id="generate-program-and-memory-maps">
<h4>Generate program and memory maps<a class="headerlink" href="#generate-program-and-memory-maps" title="Permalink to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Generated File</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>prog.dat</p></td>
<td><p>Actual program bytes (in hex-ascii) for <code class="docutils literal notranslate"><span class="pre">i2c_chunk</span></code> to run</p></td>
</tr>
<tr class="row-odd"><td><p>prog.vh</p></td>
<td><p>Map of all values read and their locations and sizes in memory (Verilog format)</p></td>
</tr>
<tr class="row-even"><td><p>prog.h</p></td>
<td><p>Map of all values read and their locations and sizes in memory (C format)</p></td>
</tr>
<tr class="row-odd"><td><p>prog.json</p></td>
<td><p>Map of all values read and their locations and sizes in memory (JSON format)</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="test-1-decode-the-program">
<h4>Test 1: Decode the program<a class="headerlink" href="#test-1-decode-the-program" title="Permalink to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">decode</span></code></p>
<p>A handy tool included here is a decoder that is “platform-aware”.  This decoder attempts to recognize
reads and writes to various ICs based on their I2C address.  If it is known to the Marble I2C map, it
replaces the address with the IC name in the output, making it easier to read.</p>
</section>
<section id="test-2-decode-the-program-without-platform-awareness">
<h4>Test 2: Decode the program without platform awareness<a class="headerlink" href="#test-2-decode-the-program-without-platform-awareness" title="Permalink to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">generic_decode</span></code></p>
<p>As a contrast to the above, the program can also be decoded with the generic decoder included with the
i2cbridge tools.  Note the difference in readability from the application perspective.</p>
</section>
<section id="test-3-test-assembler-violations">
<h4>Test 3: Test assembler violations<a class="headerlink" href="#test-3-test-assembler-violations" title="Permalink to this heading"></a></h4>
<p>This last test is not truly platform-specific but shows various violations of the I2C assembler rules
using the Marble platform-aware interface.  None of the rules violated are specific to the platform.</p>
<p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code></p>
<p>See <code class="docutils literal notranslate"><span class="pre">demo_i2c_baddy.py</span></code> for examples of what to avoid.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../README_md.html" class="btn btn-neutral float-left" title="test_marble_family README" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../rtsim/README_md.html" class="btn btn-neutral float-right" title="rtsim README" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, LBNL ATG.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>